import{d as t,c as e,u as a}from"../../../nitro/nitro.mjs";const o=t((async t=>{const o=t.context.params.symbol;if(!o)throw e({statusCode:400,statusMessage:"缺少股票代碼"});try{const t=a(),e=new Date,r=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=await fetch(`${t.public.twseApiBase}/exchangeReport/STOCK_DAY?stockNo=${o}&date=${r}${n}01`);if(!s.ok)throw new Error(`無法獲取股票資料：${s.statusText}`);const c=await s.json();if(!c||!Array.isArray(c)||0===c.length)throw new Error("無效的股票資料回應");const l=c[c.length-1],h=parseFloat(l.Close);let i=0,g=0;if(c.length>1){const t=parseFloat(c[c.length-2].Close);i=h-t,g=i/t*100}return{symbol:o,price:h,change:i,changePercent:g,date:l.Date,volume:parseInt(l.Volume.replace(/,/g,""),10)}}catch(t){return console.error(`擷取股票 ${o} 資料時發生錯誤:`,t),{symbol:o,price:Math.floor(500*Math.random())+50,change:10*Math.random()-5,changePercent:5*Math.random()-2.5,date:(new Date).toISOString().split("T")[0],volume:Math.floor(1e7*Math.random())}}}));export{o as default};
//# sourceMappingURL=_symbol_.get.mjs.map
