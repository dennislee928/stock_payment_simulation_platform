# 🧠 Next.js 高階觀念補充 Cheat Sheet

## ✅ SEO 與 metadata 管理

使用 metadata API 管理動態標題、描述、OpenGraph 以及自動產生 robots.txt 和 sitemap.xml

```mermaid
flowchart TD
    A[metadata static] -->|export const metadata| B[title, description]
    A --> C[OpenGraph, Twitter Card]
    D[generateMetadata()] -->|SSR 動態產生| B
    B --> E[Next SEO Friendly 頁面]
```

## ✅ 圖片與資源優化（Image）

Next.js Image 元件自動處理壓縮、懶加載、CDN 分發與不同 viewport 大小

```mermaid
sequenceDiagram
    participant Dev as 開發者
    participant NextImg as <Image />
    participant User as 使用者瀏覽器
    Dev->>NextImg: 設定 src, width, height
    NextImg->>User: lazy-load 適合的解析度
    Note right of User: WebP, AVIF 轉換
```

## ✅ Edge Functions 與 Runtime 選擇

根據 route 或 API 需求選擇 edge function 或 node runtime，強化效能與資安

```mermaid
flowchart LR
    A[API Route] -->|需要快速回應| B[Edge Runtime]
    A -->|需要 DB/secret| C[Node.js Runtime]
    B --> D[低延遲]
    C --> E[複雜邏輯]
```

## ✅ 環境變數與部署管理

利用 .env.local / .env.production 管理不同階段變數，並在 Vercel/Cloudflare Pages 設定 UI 變數

```mermaid
graph TD
    A[.env.local] --> B[NEXT_PUBLIC_API_URL]
    A --> C[SECRET_KEY]
    B -->|公開| D[瀏覽器可見]
    C -->|僅 server| E[後端處理]
```

## ✅ CI/CD 與 Build 設定

整合 GitHub Actions，使用 `next.config.js` 自定義 basePath、i18n、trailingSlash 等

```mermaid
flowchart LR
    A[GitHub Push] --> B[GitHub Actions]
    B --> C[npm run build]
    C --> D[next.config.js options]
    D --> E[App 部署成功]
```

